<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Web Dice</title>
    <style>
        :root {
            --dice-size: 100px;
            /* èƒŒæ™¯è‰²ã®è‰²ç›¸å¤‰æ•° (åˆæœŸå€¤: ç´«) */
            --bg-hue: 265;
            --bg-grad: radial-gradient(circle at center, hsl(var(--bg-hue), 70%, 20%) 0%, #000 100%);
            
            /* JSã‹ã‚‰åˆ¶å¾¡ã™ã‚‹å¤‰æ•° */
            --duration: 3s;
            --power-level: 1; 
            --target-x: 0deg;
            --target-y: 0deg;
            --target-z: 0deg;
            /* ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ç”¨ */
            --tx: 0px; --ty: 0px;
        }

        body {
            margin: 0; height: 100vh; overflow: hidden;
            display: flex; justify-content: center; align-items: center;
            background: var(--bg-grad); color: #fff;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            touch-action: none;
            /* è¦–ç‚¹ã‚’å®Œå…¨ãªä¸­å¿ƒã«å›ºå®š */
            perspective: 1000px;
            perspective-origin: 50% 50%;
            transition: background 0.5s;
        }

        /* --- UI (ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ & ã‚µã‚¦ãƒ³ãƒ‰) --- */
        .color-picker {
            position: absolute; top: 20px; right: 20px;
            display: flex; gap: 15px; z-index: 100; align-items: center;
        }
        .color-dot {
            width: 24px; height: 24px; border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.5); cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        .color-dot:hover { transform: scale(1.2); border-color: #fff; }

        /* BGMã‚ªãƒ³ã‚ªãƒ•ãƒœã‚¿ãƒ³ */
        .sound-btn {
            font-size: 24px; cursor: pointer; opacity: 0.5;
            transition: opacity 0.3s, transform 0.2s;
            user-select: none;
            margin-right: 10px;
            text-shadow: 0 0 5px rgba(255,255,255,0.5);
        }
        .sound-btn:hover { transform: scale(1.1); opacity: 1; }

        /* --- ã‚«ãƒ¡ãƒ©ãƒªã‚° --- */
        .camera-rig {
            position: relative;
            width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.1, 0.6, 0.1, 1);
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã®ã‚«ãƒ¡ãƒ©æºã‚Œ */
        .animating .camera-rig {
            animation: cameraShake var(--duration) cubic-bezier(.36,.07,.19,.97) both;
        }

        /* ã‚ºãƒ¼ãƒ æ™‚ï¼šçœŸæ­£é¢ã‹ã‚‰ã‚®ãƒªã‚®ãƒªã¾ã§è¿‘ã¥ãï¼ˆä¸­å¤®è¡¨ç¤ºï¼‰ */
        .zoomed .camera-rig {
            transform: translateZ(550px); 
        }

        /* --- 3Dã‚·ãƒ¼ãƒ³ --- */
        .scene {
            position: relative; transform-style: preserve-3d;
            width: var(--dice-size); height: var(--dice-size);
            display: flex; justify-content: center; align-items: center;
            transform: translateY(0); /* ç”»é¢ä¸­å¤® */
        }

        /* åºŠ */
        .floor {
            position: absolute; width: 300vw; height: 300vw;
            background: 
                linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 80px 80px;
            /* ã‚µã‚¤ã‚³ãƒ­ã®ä¸­å¿ƒã‹ã‚‰å¥¥ã¸é…ç½® */
            transform: translateZ(-80px);
            pointer-events: none;
            mask-image: radial-gradient(circle, black 20%, transparent 60%);
        }

        /* --- ã‚µã‚¤ã‚³ãƒ­ã®å‹•ããƒ©ãƒƒãƒ‘ãƒ¼ --- */
        
        /* ä¸Šä¸‹ã®ãƒã‚¦ãƒ³ãƒ‰æ‹…å½“ */
        .dice-bounce {
            width: 100%; height: 100%;
            position: absolute; transform-style: preserve-3d;
            transform: translateY(-200vh); /* åˆæœŸä½ç½® */
        }

        /* å›è»¢æ‹…å½“ */
        .dice-rotate {
            width: 100%; height: 100%;
            position: absolute; transform-style: preserve-3d;
        }

        /* ã‚µã‚¤ã‚³ãƒ­æœ¬ä½“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .face {
            position: absolute; width: 100%; height: 100%;
            background: #fff;
            border: 2px solid #ccc; border-radius: 16px;
            box-sizing: border-box;
            box-shadow: 0 0 15px rgba(255,255,255,0.2), inset 0 0 20px rgba(0,0,0,0.1);
            backface-visibility: hidden; /* è£é¢éè¡¨ç¤º */
        }
        
        /* ãƒ‰ãƒƒãƒˆ */
        .dot {
            position: absolute; background: #222; border-radius: 50%;
            box-shadow: inset 1px 1px 3px rgba(0,0,0,0.5);
            transform: translate(-50%, -50%);
        }
        .face.one .dot { background: #e60044; width: 34px; height: 34px; left: 50%; top: 50%; }
        .face:not(.one) .dot { width: 22px; height: 22px; }

        /* ãƒ‰ãƒƒãƒˆä½ç½®å®šç¾© */
        .face.two .d1{top:25%;left:25%} .face.two .d2{top:75%;left:75%}
        .face.three .d1{top:25%;left:25%} .face.three .d2{top:50%;left:50%} .face.three .d3{top:75%;left:75%}
        .face.four .d1{top:25%;left:25%} .face.four .d2{top:25%;left:75%} .face.four .d3{top:75%;left:25%} .face.four .d4{top:75%;left:75%}
        .face.five .d1{top:25%;left:25%} .face.five .d2{top:25%;left:75%} .face.five .d3{top:50%;left:50%} .face.five .d4{top:75%;left:25%} .face.five .d5{top:75%;left:75%}
        .face.six .d1{top:25%;left:25%} .face.six .d2{top:25%;left:75%} .face.six .d3{top:50%;left:25%} .face.six .d4{top:50%;left:75%} .face.six .d5{top:75%;left:25%} .face.six .d6{top:75%;left:75%}

        /* é¢ã®é…ç½® (ç«‹æ–¹ä½“) */
        .f1 { transform: rotateY(0deg) translateZ(50px); }
        .f2 { transform: rotateX(-90deg) translateZ(50px); }
        .f3 { transform: rotateY(90deg) translateZ(50px); }
        .f4 { transform: rotateY(-90deg) translateZ(50px); }
        .f5 { transform: rotateX(90deg) translateZ(50px); }
        .f6 { transform: rotateY(180deg) translateZ(50px); }

        /* --- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ --- */
        .shadow {
            position: absolute; width: 140px; height: 140px;
            background: rgba(0,0,0,0.8); border-radius: 50%; filter: blur(15px);
            transform: rotateX(90deg) translateZ(-80px) scale(0);
            pointer-events: none;
        }
        .ripple {
            position: absolute; width: 180px; height: 180px;
            border: 4px solid rgba(255,255,255,0.5); border-radius: 50%;
            transform: rotateX(90deg) translateZ(-80px) scale(0);
            opacity: 0; pointer-events: none;
        }
        .particles-container {
            position: absolute; width: 0; height: 0;
            transform: translateZ(-50px); pointer-events: none;
        }
        .particle {
            position: absolute; width: 8px; height: 8px; background: #fff;
            border-radius: 50%; box-shadow: 0 0 10px rgba(255,255,255,0.8); opacity: 0;
        }

        /* --- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© --- */

        /* ã‚«ãƒ¡ãƒ©ã®æºã‚Œ */
        @keyframes cameraShake {
            0% { transform: translate(0,0); }
            10%, 30%, 50%, 70% { transform: translate(calc(-2px * var(--power-level)), calc(-2px * var(--power-level))); }
            20%, 40%, 60% { transform: translate(calc(2px * var(--power-level)), calc(2px * var(--power-level))); }
            80% { transform: translate(0,0); }
        }

        /* ãƒã‚¦ãƒ³ãƒ‰ */
        @keyframes bounceCenter {
            0%   { transform: translateY(-150vh); animation-timing-function: ease-in; }
            25%  { transform: translateY(0); animation-timing-function: ease-out; }
            45%  { transform: translateY(calc(-80vh * var(--power-level))); animation-timing-function: ease-in; }
            65%  { transform: translateY(0); animation-timing-function: ease-out; }
            75%  { transform: translateY(calc(-30vh * var(--power-level))); animation-timing-function: ease-in; }
            85%  { transform: translateY(0); animation-timing-function: ease-out; }
            92%  { transform: translateY(calc(-10vh * var(--power-level))); animation-timing-function: ease-in; }
            100% { transform: translateY(0); }
        }

        /* å›è»¢ï¼ˆåˆé€Ÿã‹ã‚‰å¾ã€…ã«æ¸›é€Ÿã—ã¦æ­¢ã¾ã‚‹è‡ªç„¶ãªç‰©ç†æŒ™å‹•ï¼‰ */
        @keyframes rotateDynamic {
            0% { transform: rotateX(0) rotateY(0) rotateZ(0); }
            100% { transform: rotateX(var(--target-x)) rotateY(var(--target-y)) rotateZ(var(--target-z)); }
        }

        /* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        @keyframes rippleAnim {
            0% { opacity: 0; transform: rotateX(90deg) translateZ(-80px) scale(0); }
            20% { opacity: 1; transform: rotateX(90deg) translateZ(-80px) scale(1.5); }
            100% { opacity: 0; transform: rotateX(90deg) translateZ(-80px) scale(2.5); }
        }
        @keyframes particleBurst {
            0% { transform: translate(0,0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }
        @keyframes shadowPulse {
            0% { transform: rotateX(90deg) translateZ(-80px) scale(0); opacity: 0; }
            25% { transform: rotateX(90deg) translateZ(-80px) scale(1.5); opacity: 0.8; }
            45% { transform: rotateX(90deg) translateZ(-80px) scale(0.5); opacity: 0.3; }
            65% { transform: rotateX(90deg) translateZ(-80px) scale(1.2); opacity: 0.8; }
            100% { transform: rotateX(90deg) translateZ(-80px) scale(1); opacity: 0.6; }
        }

        .animating .dice-bounce { animation: bounceCenter var(--duration) forwards; }
        .animating .dice-rotate { animation: rotateDynamic var(--duration) cubic-bezier(.25, .8, .25, 1) forwards; }
        .animating .ripple { animation: rippleAnim var(--duration) forwards; }
        .animating .shadow { animation: shadowPulse var(--duration) forwards; }
        .animating .particle { animation: particleBurst 0.6s ease-out forwards 0.1s; }

        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸UI */
        .ui { position: absolute; bottom: 10%; width: 100%; text-align: center; pointer-events: none; }
        .msg { font-size: 1.5rem; letter-spacing: 2px; text-shadow: 0 0 10px rgba(255,255,255,0.5); transition: opacity 0.3s; }
        .hide { opacity: 0; }

    </style>
</head>
<body>

    <div class="color-picker">
        <div class="sound-btn" id="soundBtn" onclick="toggleSound()">ğŸ”‡</div> <div class="color-dot" style="background: hsl(265, 70%, 50%)" onclick="setHue(265)"></div> <div class="color-dot" style="background: hsl(210, 70%, 50%)" onclick="setHue(210)"></div> <div class="color-dot" style="background: hsl(0, 70%, 50%)"   onclick="setHue(0)"></div>   <div class="color-dot" style="background: hsl(120, 70%, 50%)" onclick="setHue(120)"></div> <div class="color-dot" style="background: #333"                 onclick="setHue(-1)"></div>  </div>

    <div class="camera-rig" id="cameraRig">
        <div class="scene">
            <div class="floor"></div>
            
            <div class="dice-bounce">
                <div class="dice-rotate">
                    <div class="face one f1"><div class="dot"></div></div>
                    <div class="face two f2"><div class="dot d1"></div><div class="dot d2"></div></div>
                    <div class="face three f3"><div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div></div>
                    <div class="face four f4"><div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div><div class="dot d4"></div></div>
                    <div class="face five f5"><div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div><div class="dot d4"></div><div class="dot d5"></div></div>
                    <div class="face six f6"><div class="dot d1"></div><div class="dot d2"></div><div class="dot d3"></div><div class="dot d4"></div><div class="dot d5"></div><div class="dot d6"></div></div>
                </div>
            </div>

            <div class="shadow"></div>
            <div class="ripple"></div>
            <div class="particles-container" id="particles"></div>
        </div>
    </div>

    <div class="ui">
        <div class="msg" id="msg">SWIPE TO ROLL</div>
    </div>

    <script>
        const body = document.body;
        const msg = document.getElementById('msg');
        const particlesContainer = document.getElementById('particles');
        let isRolling = false;
        let startY, startTime;

        // --- Web Audio API (ãƒ—ãƒ­å“è³ªã‚µã‚¦ãƒ³ãƒ‰) ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const ctx = new AudioContext();
        
        let isSoundOn = false; 
        let bgmNodes = [];     
        let bgmGain = null;    

        // ã‚µã‚¦ãƒ³ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
        function toggleSound() {
            if (ctx.state === 'suspended') ctx.resume();
            isSoundOn = !isSoundOn;
            
            Â  Â  Â  Â  Â  Â  const btn = document.getElementById('soundBtn');
Â  Â  Â  Â  Â  Â  btn.textContent = isSoundOn ? 'ğŸ”Š' : 'ğŸ”‡';
Â  Â  Â  Â  Â  Â  btn.style.opacity = isSoundOn ? '1' : '0.5';

Â  Â  Â  Â  Â  Â  // ã‚µã‚¤ã‚³ãƒ­åœæ­¢ä¸­ã¯é³´ã‚‰ã•ãšã€å›è»¢ä¸­ã®ã¿é³´ã‚‰ã™æ–¹é‡ã«å¤‰æ›´
Â  Â  Â  Â  Â  Â  if (!isSoundOn) {
Â  Â  Â  Â  Â  Â  Â  Â  stopBGM();
Â  Â  Â  Â  Â  Â  } else if (isRolling) {
Â  Â  Â  Â  Â  Â  Â  Â  startBGM();
Â  Â  Â  Â  Â  Â  }
        }

        // BGMç”Ÿæˆ (ä¸å”å’ŒéŸ³ã‚’é˜²ããŸã‚ã€ç´”ç²‹ãªã‚µã‚¤ãƒ³æ³¢ã®ã¿ä½¿ç”¨)
        function startBGM() {
            if (bgmNodes.length > 0) return; 

            bgmGain = ctx.createGain();
            bgmGain.gain.value = 0; 
            bgmGain.connect(ctx.destination);
            // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³
            bgmGain.gain.linearRampToValueAtTime(0.1, ctx.currentTime + 2);

            // ã‚³ãƒ¼ãƒ‰æ§‹æˆéŸ³ (Cadd9çš„ãªæ§‹æˆã§æ¿ã‚Šã‚’æ¸›ã‚‰ã™)
            const freqs = [261.63, 392.00, 523.25, 587.33]; // C4, G4, C5, D5
            
            freqs.forEach((f, i) => {
                const osc = ctx.createOscillator();
                osc.type = 'sine'; // ä¸‰è§’æ³¢(triangle)ã‚’ã‚„ã‚ã€æ¿ã‚Šã®ãªã„Sineæ³¢ã«çµ±ä¸€
                osc.frequency.value = f;
                
                // æºã‚‰ã(LFO)ã‚‚æ¥µåŠ›å°ã•ãã—ã¦éŸ³ç—´ã«èã“ãˆãªã„ã‚ˆã†ã«ã™ã‚‹
                const lfo = ctx.createOscillator();
                lfo.type = 'sine';
                lfo.frequency.value = 0.05; // éå¸¸ã«ã‚†ã£ãã‚Š
                const lfoGain = ctx.createGain();
                lfoGain.gain.value = 0.5; // æºã‚Œå¹…ã‚’æ¥µå°ã«
                lfo.connect(lfoGain);
                lfoGain.connect(osc.frequency);
                lfo.start();

                const nodeGain = ctx.createGain();
                nodeGain.gain.value = 0.05; // éŸ³é‡æ§ãˆã‚
                
                osc.connect(nodeGain);
                nodeGain.connect(bgmGain);
                osc.start();
                
                // åœæ­¢ç”¨ã«ãƒãƒ¼ãƒ‰ã‚’ä¿å­˜ï¼ˆLFOã‚‚å«ã‚ã‚‹ï¼‰
                bgmNodes.push(osc);
                bgmNodes.push(lfo);
            });
        }

        // BGMå®Œå…¨åœæ­¢ï¼ˆä¸å”å’ŒéŸ³ã®åŸå› ã¨ãªã‚‹æ®‹ç•™ãƒã‚¤ã‚ºã‚’æ¶ˆã™ï¼‰
        function stopBGM() {
            if (bgmGain) {
                // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã—ã¦ã‹ã‚‰åœæ­¢
                bgmGain.gain.setTargetAtTime(0, ctx.currentTime, 0.1);
                setTimeout(() => {
                    bgmNodes.forEach(node => {
                        try { node.stop(); node.disconnect(); } catch(e){}
                    });
                    bgmNodes = [];
                    if(bgmGain) { bgmGain.disconnect(); bgmGain = null; }
                }, 200);
            } else {
                bgmNodes = [];
            }
        }

                // è»¢ãŒã‚‹éŸ³ (Collision Sound)
        const playRollSound = () => {
            if (!isSoundOn) return;
            // çŸ­ã„æŒ¯å‹•ã§ã‚³ãƒ„ã‚³ãƒ„æ„Ÿã‚’æ¼”å‡º
            if (navigator.vibrate) navigator.vibrate(15);
            if (ctx.state === 'suspended') ctx.resume();
            const t = ctx.currentTime;
            
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(150 + Math.random() * 50, t);
            osc.frequency.exponentialRampToValueAtTime(40, t + 0.1);
            
            gain.gain.setValueAtTime(0.1, t);
            gain.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
            
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.start(t);
            osc.stop(t + 0.1);
        };

                // æ±ºå®šéŸ³ (Win Sound)
        const playWinSound = () => {
            if (!isSoundOn) return;
            // é•·ã‚ã®æŒ¯å‹•ã§ç¢ºå®šã‚’æ¼”å‡º
            if (navigator.vibrate) navigator.vibrate(200);
            if (ctx.state === 'suspended') ctx.resume();
            const t = ctx.currentTime;
            
            const freqs = [523.25, 659.25, 783.99, 987.77, 1046.50]; 
            
            freqs.forEach((f, i) => {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = 'sine';
                osc.frequency.value = f;
                
                const start = t + (i * 0.05);
                const dur = 1.5;

                gain.gain.setValueAtTime(0, start);
                gain.gain.linearRampToValueAtTime(0.15, start + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.001, start + dur);

                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.start(start);
                osc.stop(start + dur);
            });
        };

        // --- ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«åˆæœŸåŒ– ---
        for(let i=0; i<16; i++){
            let p = document.createElement('div');
            p.className = 'particle';
            let angle = Math.random() * Math.PI * 2;
            let dist = 100 + Math.random() * 150;
            p.style.setProperty('--tx', `${Math.cos(angle)*dist}px`);
            p.style.setProperty('--ty', `${Math.sin(angle)*dist}px`);
            particlesContainer.appendChild(p);
        }

        // --- ã‚µã‚¤ã‚³ãƒ­ãƒ­ã‚¸ãƒƒã‚¯ ---
        const getTarget = (num) => {
            const base = {
                1: {x:0, y:0}, 2: {x:90, y:0}, 3: {x:0, y:90},
                4: {x:0, y:-90}, 5: {x:-90, y:0}, 6: {x:180, y:0}
            }[num];
            // ã‚ãšã‹ãªãƒ©ãƒ³ãƒ€ãƒ å‚¾ã
            const r = () => (Math.random() - 0.5) * 10;
            return { x: base.x + r(), y: base.y + r(), z: r() };
        };

        // èƒŒæ™¯è‰²å¤‰æ›´
        function setHue(hue) {
            const root = document.documentElement;
            if (hue === -1) {
                root.style.setProperty('--bg-grad', 'radial-gradient(circle at center, #333 0%, #000 100%)');
            } else {
                root.style.setProperty('--bg-hue', hue);
                root.style.setProperty('--bg-grad', `radial-gradient(circle at center, hsl(var(--bg-hue), 70%, 20%) 0%, #000 100%)`);
            }
        }

        // ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¤ãƒ™ãƒ³ãƒˆ
        document.addEventListener('touchstart', e => {
            if(isRolling) return;
            startY = e.touches[0].clientY;
            startTime = Date.now();
        }, {passive:false});

        document.addEventListener('touchend', e => {
            if(isRolling) return;
            if (e.target.closest('.color-picker')) return;

            const dist = Math.abs(startY - e.changedTouches[0].clientY);
            const time = Date.now() - startTime;
            if(dist < 10) return; 

            let speed = dist / time;
            let power = Math.min(Math.max(speed / 2.0, 0.4), 1.2); 
            rollDice(power);
        }, {passive:false});

        // PCãƒ‡ãƒãƒƒã‚°ç”¨ã‚¯ãƒªãƒƒã‚¯
        document.addEventListener('click', (e) => { 
            if(e.target.closest('.color-picker')) return;
            if(!isRolling) rollDice(0.8); 
        });

        Â  Â  Â  Â  function rollDice(power) {
Â  Â  Â  Â  Â  Â  isRolling = true;
Â  Â  Â  Â  Â  Â  if (isSoundOn) startBGM(); // å›è»¢é–‹å§‹ã§BGMå†ç”Ÿ
Â  Â  Â  Â  Â  Â  body.classList.remove('zoomed', 'animating');
Â  Â  Â  Â  Â  Â  msg.classList.add('hide');

            // è¨ˆç®—
            const result = Math.floor(Math.random() * 6) + 1;
            const baseTarget = getTarget(result);
            const duration = 2.0 + power * 2.0;

            // å›è»¢æ•°è¨ˆç®— (å‹¢ã„ãŒã‚ã‚‹ã»ã©å¤šãå›ã‚‹)
            const spins = 4 + Math.floor(power * 8); 
            const target = {
                x: baseTarget.x + (spins * 360),
                y: baseTarget.y + (spins * 360),
                z: baseTarget.z + (Math.floor(Math.random() * 3) * 360) 
            };

            // CSSå¤‰æ•°ã‚»ãƒƒãƒˆ
            const root = document.documentElement;
            root.style.setProperty('--power-level', power);
            root.style.setProperty('--duration', `${duration}s`);
            root.style.setProperty('--target-x', `${target.x}deg`);
            root.style.setProperty('--target-y', `${target.y}deg`);
            root.style.setProperty('--target-z', `${target.z}deg`);

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
            setTimeout(() => {
                body.classList.add('animating');
                
                // è»¢ãŒã‚‹éŸ³ã®ãƒªã‚ºãƒ ç”Ÿæˆ
                const impactTimes = [0, 200, 450, 750, 1100, 1500, 2000, 2600, 3300]; 
                impactTimes.forEach(time => {
                    if (time < duration * 1000) {
                        setTimeout(playRollSound, time);
                    }
                });

                Â  Â  Â  Â  Â  Â  Â  Â  // çµ‚äº†å¾Œã‚ºãƒ¼ãƒ 
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stopBGM(); // çµæœãŒå‡ºãŸã‚‰BGMåœæ­¢
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  playWinSound(); // æ±ºå®šéŸ³
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body.classList.add('zoomed');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isRolling = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => msg.classList.remove('hide'), 800);
Â  Â  Â  Â  Â  Â  Â  Â  }, duration * 1000);

            }, 50);
        }
    </script>



<script id="lfs-meta" type="application/json">
{
  "appId": "d81eb0d9a1b35993ef55e42a353f2638",
  "createdAt": "2026-01-03T05:46:23.139Z",
  "schema": 2,
  "title": "Ultimate Web Dice",
  "savedAt": "2026-01-10T17:10:23.645Z",
  "aiInstruction": "ã‚¢ãƒ—ãƒªã«ã€ŒæŒ¯å‹•ï¼ˆãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã€æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã€ãƒªã‚¢ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã¦ãã ã•ã„ã€‚\n\nã€è¦ä»¶ã€‘\n1. navigator.vibrate APIã‚’ä½¿ç”¨ã™ã‚‹ã€‚\n2. éŸ³ã¨é€£å‹•ã—ã¦æŒ¯å‹•ã•ã›ã‚‹ï¼š\n   - ã‚µã‚¤ã‚³ãƒ­ãŒè»¢ãŒã‚‹éŸ³ï¼ˆplayRollSoundé–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰ã§ã€éå¸¸ã«çŸ­ãï¼ˆ15msç¨‹åº¦ï¼‰æŒ¯å‹•ã•ã›ã‚‹ã€‚\n   - çµæœãŒå‡ºã¦ã‚ºãƒ¼ãƒ ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆplayWinSoundé–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰ã§ã€å°‘ã—é•·ã‚ã«ï¼ˆ200msç¨‹åº¦ï¼‰æŒ¯å‹•ã•ã›ã‚‹ã€‚\n3. ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®æ©Ÿèƒ½æ‹¡å¼µï¼š\n   - ç”»é¢å³ä¸Šã®ã‚µã‚¦ãƒ³ãƒ‰ãƒœã‚¿ãƒ³ï¼ˆ#soundBtnï¼‰ã‚’æŠ¼ã—ã¦ã€ŒãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆğŸ”‡ï¼‰ã€ã«ã—ãŸæ™‚ã¯ã€æŒ¯å‹•ã‚‚ä¸€ç·’ã«OFFã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚\n   - éŸ³ãŒONï¼ˆğŸ”Šï¼‰ã®æ™‚ã ã‘ã€æŒ¯å‹•ã‚‚ç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«æ¡ä»¶åˆ†å²ã‚’è¿½åŠ ã™ã‚‹ã€‚",
  "comment": "ã‚¢ãƒ—ãƒªã«ã€ŒæŒ¯å‹•ï¼ˆãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã€æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã€ãƒªã‚¢ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã¦ãã ã•ã„ã€‚\n\nã€è¦ä»¶ã€‘\n1. navigator.vibrate APIã‚’ä½¿ç”¨ã™ã‚‹ã€‚\n2. éŸ³ã¨é€£å‹•ã—ã¦æŒ¯å‹•ã•ã›ã‚‹ï¼š\n   - ã‚µã‚¤ã‚³ãƒ­ãŒè»¢ãŒã‚‹éŸ³ï¼ˆplayRollSoundé–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰ã§ã€éå¸¸ã«çŸ­ãï¼ˆ15msç¨‹åº¦ï¼‰æŒ¯å‹•ã•ã›ã‚‹ã€‚\n   - çµæœãŒå‡ºã¦ã‚ºãƒ¼ãƒ ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆplayWinSoundé–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰ã§ã€å°‘ã—é•·ã‚ã«ï¼ˆ200msç¨‹åº¦ï¼‰æŒ¯å‹•ã•ã›ã‚‹ã€‚\n3. ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®æ©Ÿèƒ½æ‹¡å¼µï¼š\n   - ç”»é¢å³ä¸Šã®ã‚µã‚¦ãƒ³ãƒ‰ãƒœã‚¿ãƒ³ï¼ˆ#soundBtnï¼‰ã‚’æŠ¼ã—ã¦ã€ŒãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆğŸ”‡ï¼‰ã€ã«ã—ãŸæ™‚ã¯ã€æŒ¯å‹•ã‚‚ä¸€ç·’ã«OFFã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚\n   - éŸ³ãŒONï¼ˆğŸ”Šï¼‰ã®æ™‚ã ã‘ã€æŒ¯å‹•ã‚‚ç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«æ¡ä»¶åˆ†å²ã‚’è¿½åŠ ã™ã‚‹ã€‚",
  "sourceMode": "project",
  "runId": "929bcba43ff5609a8d4c2dbc0b2001c8"
}
</script>
</body>
</html>